<div class="page-header">
  <h1><%= @repository.name %></h1>
</div>

<p>
  <strong>Address:</strong>
  <%= @repository.address %>
</p>

<p>
  <strong>Configuration:</strong>
  <%= @configuration.name %>
</p>

<hr/>

<h2>Processing information</h2>

<p>
  <strong>State:</strong>
  <%= @processing.state %>
</p>

<p>
  <strong>Creation date:</strong>
  <%= @processing.date.strftime("%Y/%m/%d at %Hh%M (%z)") %>
</p>

<% unless @processing.process_times.nil? %>
  <% @processing.process_times.each do |process_time| %>
    <p>
      <strong><%= process_time.state %> time:</strong>
      <%= humanize_eplased_time(process_time.time) %>
    </p>
  <% end %>
<% end %>
<hr/>
<% if @processing.ready? %>
  <h2>Source Tree</h2>
  <h3><%= @module_results.module.name  %></h3>
  <h3><%= @module_results.grade %> </h3>
  <% children = @module_results.children %>
  <% unless children.empty? %>
   <table class="table table-hover">
    <thead>
     <th>Name</th>
     <th>Granularity</th>
     <th>Grade</th>
  </thead>
    <tbody>
      <%= render partial: 'module_result', collection: children %> 
    </tbody>
  </table>
  <% end %>
<% end %>

<% if @processing.ready? %>
  <table class="table table-hover">
    <thead>
      <th>Metric</th>
      <th>Value</th>
      <th>Weight</th>
      <th>Threshold</th>
    </thead>

    <tbody>
      <%= render partial: 'metric_result', collection: @metric_results %>
    </tbody>

  </table>
<% end %>

<hr/>

<%= link_to 'Back',  project_path(@repository.project_id), class: 'btn btn-default' %>
<% if project_owner? @repository.project_id %>
  <%= link_to 'Destroy', project_repository_path(@repository.project_id, @repository.id), method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-danger' %>
<% end %>
